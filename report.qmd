---
title: "EV Power - Lab 4 Project Report"
format: typst
---
## **Part 0: libraries**

```{r}
library(tidyverse)
library(sf)
library(janitor)
library(patchwork)
library(tigris)```

## **Part 1:** **Defining Research Question**

Chosen Question: Do states with higher renewable electricity shares also have higher EV adoption and how does price relate?
## **Part 2: Data Preparation and Cleaning**

```{r}
renew_files <- list.files("data", pattern = "renew-use-.*\\.csv$", full.names = TRUE)
total_files <- list.files("data", pattern = "total-use-.*\\.csv$", full.names = TRUE)

price <- read_csv("data/av-energy-price-2021-2023.csv")
ev    <- read_csv("data/ev-registrations-by-state-2023.csv")

renew <- map_dfr(renew_files, read_csv, .id = "file") |>
  mutate(year = str_extract(file, "202\\d"))

total <- map_dfr(total_files, read_csv, .id = "file") |>
  mutate(year = str_extract(file, "202\\d"))```

## **Part 3: Joining / Pivoting Datasets for Analysis**

```{r}
energy <- left_join(
  renew |> select(1, 2, year),
  total |> select(1, 2, year),
  by = c("file" = "file", "year" = "year"),
  suffix = c("_renew", "_total")) |>
  mutate(pct_renew = 100 * as.numeric(State) / as.numeric(Energy_Source))```

## **Part 4: Mapping Visualization**

```{r}
ggplot(energy, aes(x = year, y = pct_renew)) +
  geom_col(fill = "steelblue") +
  labs(title = "Renewable Share by Year", x = "Year", y = "Renewable (%)")```

## Overview: This data is supposed to help me visualize and compare high vs low renewable energy share states so that I can see a direct correlation between energy shares and EV adoption; however, I came across a couple of errors when trying to pivot and join the energy data set. I planned on mutating a new column called pct_renew so that I can visualize the desired data, but I came across various errors when doing so. Despite this, I initially hypothesized that this is not the case since there are other factors to take into account like the price of electricity and state policy. 
